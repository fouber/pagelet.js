!function(a){"use strict";function b(){}function c(a){var b=$docm.createElement("script");e(b,$docm.createTextNode(a)),e(t,b)}function d(a){return!!a}function e(a,b){return a.appendChild(b)}function f(a,b){return Object.prototype.toString.call(a).toLowerCase()==="[object "+b+"]"}function g(a,c,d){var f,g="js"===c,h="css"===c,i=document.createElement(g?"script":"link"),j="onload"in i,k=setTimeout(function(){clearTimeout(k),clearInterval(f),d("timeout")},q);g?(i.type="text/javascript",i.async="async",i.src=a):(h&&(i.type="text/css",i.rel="stylesheet"),i.href=a),i.onload=i[o]=function(){!i||i[p]&&!/loaded|complete/.test(i[p])||(clearTimeout(k),i.onload=i[o]=b,g&&t&&i.parentNode&&t.removeChild(i),d(),i=null)},i.onerror=function(b){clearTimeout(k),clearInterval(f),b=(b||{}).error||new Error("load resource timeout"),b.message="Error loading ["+a+"]: "+b.message,d(b)},e(t,i),h&&(s||!j)&&(f=setInterval(function(){i.sheet&&(clearTimeout(id),clearInterval(f),d())},20))}function h(a){for(var b={},c=0;c<v.length;c++)b[v[c]]={};a.emit=function(c,d){var e=d.replace(/(\?.*)/,""),f=b[c];for(var g in f){var h=f[g].routeData.route_reg,i=new RegExp(h),j=e.match(i);if(null!=j){for(var k=f[g].fn,l=f[g].routeData.params_count,m=[],n=1;l>=n;n++)j[n]&&m.push(j[n]);var o=[].slice.call(arguments);return o.shift(),o.push(m),k.apply(a,o)}}return!1},a.on=function(a,c,d){var e=b[a][c];e||(e=b[a][c]={},e.fn=d,e.routeData=i(c))}}function i(a){var b=/\(.+\)/g,c=/:\w+\/?/g,d=a.split(":").length-1,e=a.replace(c,function(a){var b="{[^/]+}",c=-1!=a.indexOf("/");return c&&(b+="/"),b});e=e.replace(b,function(a){var b=a.replace("(","(?:").replace(")","|)");return b});var e=e.replace("*",".*"),f=/{/g;e=e.replace(f,"(");var f=/}/g;e=e.replace(f,")");var f=/\//g;return e=e.replace(f,"\\/"),e+="$",{route_reg:e,route:a,params_count:d}}function j(a,d){document.title=a.title||document.title;var e=[],f=null;l(e,a.js,"js"),l(e,a.css,"css");var g=function(){if(a.script&&a.script.length){var d="!function(){",e="}();\n",f=d+a.script.join(e+d)+e;c(f)}g=b};if(e&&e.length){var h=e.length;e.forEach(function(b){m(b.uri,b.type,function(b){h--,0===h&&d(f,a,g,{fromCache:fromCache}),f=b})})}else d(f,a,g)}function k(a,b,c,d){try{document.activeElement.blur()}catch(e){}if(a)throw new Error(a);if("block"!=z.emit("beforeDomReplace",c,b,d)){for(var f in b)if(b.hasOwnProperty(f)){var g=document.createElement("div");g.innerHTML=b[f];var h=document.getElementById(f);h.innerHTML=g.childNodes[0].innerHTML}d()}}function l(a,b,c){if(b&&b.length&&(b=b.filter(function(a){var b=A[a]===!0;return A[a]=!0,!b}),b.length))if(B){var d=b.join(",");a.push({uri:D.replace("%s",d),type:c})}else b.forEach(function(b){a.push({uri:b,type:c})})}function m(a,c,d){var e,f="js"===c,g="css"===c,h=document.createElement(f?"script":"link"),i="onload"in h,j=setTimeout(function(){clearTimeout(j),clearInterval(e),d("timeout")},q);f?(h.type="text/javascript",h.async="async",h.src=a):(g&&(h.type="text/css",h.rel="stylesheet"),h.href=a),h.onload=h.onreadystatechange=function(){!h||h.readyState&&!/loaded|complete/.test(h.readyState)||(clearTimeout(j),h.onload=h.onreadystatechange=b,f&&head&&h.parentNode&&head.removeChild(h),d(),h=null)},h.onerror=function(b){clearTimeout(j),clearInterval(e),b=(b||{}).error||new Error("load resource timeout"),b.message="Error loading ["+a+"]: "+b.message,d(b)},head.appendChild(h),g&&(s||!i)&&(e=setInterval(function(){h&&h.sheet&&(clearTimeout(j),clearInterval(e),d())},20))}var n,o="onreadystatechange",p="readyState",q=6e4,r="/co??%s",s=+navigator.userAgent.replace(/.*AppleWebKit\/(\d+)\..*/,"$1")<536,t=document.head||document.getElementsByTagName("head")[0];g.xhr=function(){return n},g.request=function(c,d,e,f){var g=d.before||b;n&&n[p]<4&&(n[o]=b,n.abort()),n=new a.XMLHttpRequest,n.onprogress=f,n[o]=function(){if(4==n[p]){n[o]=b;var a,c=null;if(n.status>=200&&n.status<300||304==n.status){a=n.responseText;try{a=JSON.parse(a)}catch(d){c=d}c?e(c):e(null,a)}else c=n.statusText||(n.status?"error":"abort"),e(c)}},g(n),n.open("GET",c,!0),n.send()};var u,v=["beforeload","beforeDomReplace"],w=[],x=100,y={set:function(a,b){w.length>=x&&w.shift(),w.push({key:a,val:b})},get:function(a){for(var b=w.length-1;b>=0;b--)if(w[b].key==a)return w[b].val;return!1}},z=a.pagelet={},A={},B=!1,C=!0,D=r,E=a.history&&a.history.pushState&&a.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),F={};h(z),z.init=function(a,b,c){B=!!a,D=b||r,c&&c.length&&c.forEach(function(a){A[a]=!0})},z.addQuery=function(a){F=a},z.initState=function(b,c){var b=b||[],c=c||{};u||(u={url:a.location.href,title:document.title,pagelets:b,pageletOptions:c},a.history.replaceState(u,document.title))},z.go=function(b,c,d){var e=Boolean(d.stateReplace)||!1;if(E&&c&&z.initState(),"block"!=z.emit("beforeload",b,c)){z.load(b,c,d,function(e,f,g){var h=f.title||document.title,i={url:b,title:h,pagelets:c,pageletOptions:d};a.history.replaceState(i,h,b),k(e,f.html,b,g)});var f=g.xhr();f.readyState>0&&(e?a.history.replaceState(null,"",b):a.history.pushState(null,"",b))}else{var h={url:b,pagelets:c,pageletOptions:d};e?a.history.replaceState(h,"",b):a.history.pushState(h,"",b)}},z.load=function(a,c,d,e){if(c&&c.length){e=e||b,f(c,"String")&&(c=c.split(/\s*,\s*/)),c=c.join(",");var h=Boolean(d.nocache)||!1;if(C&&!h){var i=y.get(a+"-"+c);if(i)return console.log("cache hit!!"),void j(i,e)}var k=a+(-1===a.indexOf("?")?"?":"&")+"pagelets="+encodeURIComponent(c);for(var l in F)-1===a.indexOf(l)&&(k+="&"+l+"="+encodeURIComponent(F[l]));g.request(k,{before:function(a){}},function(b,d){return b?e(b):(C&&y.set(a+"-"+c,d),void j(d,e))})}else location.href=a},document.documentElement.addEventListener("click",function(a){for(var b=a.target;b&&"body"!=b.tagName.toLowerCase();){if("a"===b.tagName.toLowerCase()){var c=b.getAttribute("href"),e=(b.getAttribute("data-pagelets")||"").split(/\s*,\s*/).filter(d),f=b.getAttribute("data-pagelets-stateReplace")||!1,g=b.getAttribute("data-pagelets-nocache")||!1;if(c&&e.length>0){a.preventDefault(),a.stopPropagation();var h={stateReplace:f,nocache:g};z.go(c,e,h)}break}b=b.parentNode}}),a.addEventListener("popstate",function(a){var b=a.state;if(!b)return void(location.href=b.url);var c=b.url,d=b.pagelets;"block"!=z.emit("beforeload",c,d)&&z.load(c,d,b.pageletOptions,function(a,c,d){k(a,c.html,b.url,d)})},!1)}(window);